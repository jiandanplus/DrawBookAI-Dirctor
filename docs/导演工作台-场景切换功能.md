# 导演工作台 - 场景切换功能

## 功能概述

在导演工作台(StageDirector)中，现在可以为每个镜头手动选择和切换场景，不再局限于AI自动分配的场景。

## 使用方法

### 1. 打开镜头详情
- 在导演工作台的镜头网格中，点击任意镜头卡片
- 右侧将打开镜头详情面板（ShotWorkbench）

### 2. 切换场景
- 在镜头详情面板顶部的"场景环境 (Scene Context)"区域
- 如果项目中有多个场景，场景名称会显示为一个**下拉选择框**
- 点击下拉框，选择你想要的场景
- 场景会立即切换，场景的位置、时间、氛围等信息也会相应更新

### 3. 单场景情况
- 如果项目中只有一个场景，场景名称会以纯文本显示（不可编辑）
- 这样避免不必要的交互元素

## 功能特点

✅ **即时切换**：选择新场景后立即生效，无需额外确认  
✅ **智能显示**：单场景时显示为文本，多场景时显示为下拉框  
✅ **保持参考图**：切换场景后，新场景的参考图会自动显示  
✅ **同步信息**：场景的所有属性（位置、时间、氛围）都会同步更新  

## 技术实现

### 修改的文件
1. **SceneContext.tsx** - 添加场景选择下拉框
2. **ShotWorkbench.tsx** - 传递场景列表和切换回调
3. **index.tsx** - 实现场景切换的数据更新逻辑

### 核心逻辑
```typescript
// 在StageDirector/index.tsx中
onSceneChange={(sceneId) => updateShot(activeShot.id, s => ({ 
  ...s, 
  sceneId 
}))}
```

当用户选择新场景时：
1. 更新镜头的 `sceneId` 属性
2. UI自动重新渲染，显示新场景的信息
3. 后续生成关键帧时会使用新场景的参考图

## 注意事项

⚠️ **已生成的内容**：切换场景不会影响已生成的关键帧或视频  
⚠️ **重新生成**：如需使用新场景生成图像，请重新生成关键帧  
⚠️ **场景数量**：确保在"剧本编辑"阶段创建了多个场景，才能在导演工作台中切换  

## 使用场景示例

### 场景A：咖啡馆（白天）
角色在咖啡馆里对话

### 场景B：街道（夜晚）  
角色在街道上行走

**如果某个镜头原本被AI分配到场景A，但你认为应该在场景B拍摄，现在可以直接在导演工作台中切换场景。**

## 更新日期
2025年12月20日
